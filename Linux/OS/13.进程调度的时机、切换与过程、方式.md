### 进程调度的时机

- 进程调度(低级调度)，就是按照某种算法从就绪队列中选择一个进程为其分配处理机

- 需要进行进程调度和切换的情况

    - 当前运行的进程主动放弃处理机
        - 进程正常终止
        - 运行过程中发生异常而终止
        - 进程主动请求阻塞(如等待I/O)
        
    - 当前运行的进程被动放弃处理机
        - 分配给进程的时间片用完
        - 有更紧急的事需要处理(如I/O中断)
        - 有更优先级的进程进入就绪队列
    
- 不能进行进程调度和切换的情况
    - 在处理中断的过程中，中断处理过程复杂，与硬件模切相关，很难做到在中断处理过程中进行进程切换
    - 进程在操作系统内核程序临界区中
    - 在原子操作过程中(原语)，原子操作不可中断，要一气呵成

- 特别注意的内容
    - [x] 进程在操作系统内核程序临界区中不能进行调度和切换
    - [ ] 这句是错的，进程处理临界区不能进行调度和切换是错的
    - 什么是临界区和临界资源
        - 临界区是访问临界资源的那段代码
        - 临界资源是一段时间段内只允许一个进程使用的资源，各进程需要互斥的访问临界资源
    - 解释原因
        - 比如就绪队列就是内核代码的临界资源，如果不及时释放，极可能影响到操作系统内核其他管理工作，因此
        访问系统内核程序临界区期间内不能进行调度和切换
        - 普通代码的临界区访问资源不会直接影响操作系统的管理工作，因此访问普通的临界区时可以进行调度与切换

### 进程调度的方式

- 非剥夺调度方式，又称非抢占式。即只允许进程主动放弃处理器，在运行过程中即便有更紧迫的任务到达，当前进程依旧
会继续使用处理机，直到进程终止或主动要求进入阻塞态。实现简单、系统开销小但是无法及时处理紧任务，适用于早起的批处理系统
  
- 剥夺调度方式，又称为抢占式。当一个进程正在CPU上执行时，如果有一个更加重要或紧迫的进程需要使用处理机，则立即暂停正在
执行的进程，将处理机分配给更加紧迫的那个进程。可以优先处理更加紧急的进程，也可以实现让进程按时间片轮流执行的功能(通过时钟中断)。适用于分时、实时操作系统
  
### 进程的切换与过程

- "狭义上进程调度"与"进程切换"的区别

    - 狭义的进程调度就是值从就绪队列中选中一个要运行的进程
    - 进程切换是指一个进程让出处理机，让另一个进程占用处理机的过程
    
- "广义的进程调度"包含了选择一个进程和进程切换两个步骤

- 进程切换的过程主要完成了
    - 对原来运行进程各种数据的保存
    - 对新的进程各种数据的恢复
    
- 注意: 进程的切换是有代价的，因此如果过于频繁的进程切换、调度，必然使得整个系统的效率降低，使得操作系统大部分事件花在进程切换上，
而真正用于执行进程的事件减少

![os_schedule_switch_and_method.png](../../Images/os_schedule_switch_and_method.png)


